Merging encode instruction while maintaining main function in mark1